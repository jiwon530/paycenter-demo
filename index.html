<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <title>페이센터 — 바로 보이는 데모 (GitHub Pages용)</title>
    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React/ReactDOM UMD -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Recharts UMD -->
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
    <!-- Babel: JSX를 브라우저에서 변환 -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <!-- 앱 코드 -->
    <script type="text/babel">
      const { useState } = React;
      const {
        BarChart: RBarChart, Bar,
        LineChart: RLineChart, Line,
        XAxis, YAxis, CartesianGrid, Tooltip,
        PieChart, Pie, Cell, ResponsiveContainer
      } = Recharts;

      const IconBox = () => (
        <div className="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center text-gray-600">
          <span className="text-sm">★</span>
        </div>
      );

      function PayCenterDashboard() {
        const [activeTab, setActiveTab] = useState("dashboard");

        const benefitData = [
          { name: "신규가입 10% 할인", status: "active", budget: 50000000, used: 32000000, conversion: 8.5, type: "정률할인" },
          { name: "첫결제 캐시백", status: "active", budget: 30000000, used: 28500000, conversion: 12.3, type: "캐시백" },
          { name: "VIP 무료송금", status: "paused", budget: 20000000, used: 15000000, conversion: 6.7, type: "수수료면제" },
          { name: "여름 특가 쿠폰", status: "scheduled", budget: 40000000, used: 0, conversion: 0, type: "정액할인" }
        ];

        const performanceData = [
          { month: "1월", 발급: 45000, 사용: 38000, 전환율: 8.4 },
          { month: "2월", 발급: 52000, 사용: 44000, 전환율: 8.8 },
          { month: "3월", 발급: 48000, 사용: 42000, 전환율: 9.2 },
          { month: "4월", 발급: 58000, 사용: 51000, 전환율: 9.6 },
          { month: "5월", 발급: 62000, 사용: 56000, 전환율: 10.1 },
        ];

        const serviceDistribution = [
          { name: "결제", value: 45, color: "#4CAF50" },
          { name: "카드", value: 25, color: "#FF9800" },
          { name: "증권", value: 20, color: "#2196F3" },
          { name: "멤버십", value: 10, color: "#9C27B0" }
        ];

        const getStatusBadge = (status) => {
          const m = {
            active: ["진행중", "bg-green-100 text-green-800"],
            paused: ["일시정지", "bg-yellow-100 text-yellow-800"],
            scheduled: ["예약됨", "bg-blue-100 text-blue-800"],
            ended: ["종료", "bg-gray-100 text-gray-800"]
          }[status] || ["-", "bg-gray-100 text-gray-800"];
          return <span className={"px-2 py-1 rounded-full text-xs font-medium " + m[1]}>{m[0]}</span>;
        };

        function BenefitCreator() {
          const [selectedLogic, setSelectedLogic] = useState(null);
          const [selectedConditions, setSelectedConditions] = useState([]);
          const [showExtensionPanel, setShowExtensionPanel] = useState(false);

          const logicBlocks = [
            { id: "discount_percent", name: "정률 할인", desc: "10% 할인", color: "bg-yellow-100 border-yellow-300", phase: 1 },
            { id: "discount_fixed", name: "정액 할인", desc: "2000원 할인", color: "bg-yellow-100 border-yellow-300", phase: 1 },
            { id: "cashback", name: "캐시백", desc: "3% 적립", color: "bg-yellow-100 border-yellow-300", phase: 1 },
            { id: "points", name: "포인트", desc: "포인트 적립/차감", color: "bg-yellow-100 border-yellow-300", phase: 1 },
            { id: "coupon", name: "쿠폰 발급", desc: "할인쿠폰 자동 발급", color: "bg-yellow-100 border-yellow-300", phase: 1 },
            { id: "fee_waiver", name: "수수료 면제", desc: "송금 수수료 면제", color: "bg-yellow-100 border-yellow-300", phase: 1 },
            { id: "tier_discount", name: "등급별 할인", desc: "구매횟수별 차등 할인", color: "bg-yellow-100 border-yellow-300", phase: 2 },
            { id: "bundle_discount", name: "묶음 할인", desc: "복합 서비스 이용 할인", color: "bg-yellow-100 border-yellow-300", phase: 2 }
          ];

          const conditionBlocks = [
            { id: "amount", name: "최소 금액", desc: "30,000원 이상", phase: 1 },
            { id: "location", name: "사용 장소", desc: "편의점", phase: 1 },
            { id: "time", name: "시간 조건", desc: "오후 2-4시", phase: 1 },
            { id: "user_type", name: "사용자 조건", desc: "신규 가입자", phase: 1 },
            { id: "frequency", name: "사용 횟수", desc: "월 3회 이상", phase: 2 },
            { id: "day_of_week", name: "요일 조건", desc: "금요일만", phase: 2 },
            { id: "category_exclude", name: "카테고리 제외", desc: "담배/주류 제외", phase: 2 }
          ];

          const currentPhase = 2;

          return (
            <div className="space-y-6">
              <div className="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-6 border border-yellow-200">
                <h3 className="text-xl font-bold mb-2 text-gray-800">혜택 로직 라이브러리 - "확장 가능한 레고블록" 방식</h3>
                <p className="text-gray-700 mb-4">미리 구현된 혜택 로직을 조합하여 복잡한 혜택도 간단하게 생성 (지속적 확장 지원)</p>
                <div className="flex items-center text-sm space-x-4">
                  <span className="bg-red-100 text-red-700 px-3 py-1 rounded-full">기존: 4주 개발</span>
                  <span>→</span>
                  <span className="bg-green-100 text-green-700 px-3 py-1 rounded-full">페이센터: 5분 완성</span>
                  <span className="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full">Phase {currentPhase} 로직 활용</span>
                </div>
              </div>

              <div className="grid grid-cols-3 gap-6">
                <div className="col-span-2 bg-white rounded-lg shadow-lg p-6">
                  <div className="flex items-center justify-between mb-4">
                    <h4 className="text-lg font-bold">1단계: 기본 혜택 로직 선택</h4>
                    <button onClick={() => setShowExtensionPanel(!showExtensionPanel)} className="text-xs bg-amber-100 hover:bg-amber-200 text-amber-800 px-2 py-1 rounded">확장 관리</button>
                  </div>

                  <div className="grid grid-cols-2 gap-3">
                    {logicBlocks.map(block => (
                      <div key={block.id}
                        onClick={() => setSelectedLogic(block)}
                        className={"p-4 rounded-lg border-2 cursor-pointer transition-all hover:shadow-md " + (selectedLogic?.id === block.id ? block.color + " border-opacity-100 shadow-lg" : "border-gray-200 hover:border-gray-300")}>
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <h5 className="font-bold mb-1">{block.name}</h5>
                            <p className="text-sm text-gray-600">{block.desc}</p>
                          </div>
                          <span className={"text-xs px-2 py-1 rounded-full " + (block.phase === 1 ? "bg-blue-100 text-blue-700" : "bg-green-100 text-green-700")}>P{block.phase}</span>
                        </div>
                        {block.phase === 2 && <div className="mt-2 text-xs text-green-600">확장 로직</div>}
                      </div>
                    ))}
                  </div>

                  {showExtensionPanel && (
                    <div className="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                      <h5 className="font-bold text-yellow-800 mb-3">로직 확장 관리</h5>
                      <div className="space-y-2 text-sm">
                        <div className="flex items-center justify-between p-2 bg-white rounded"><span>등급별 할인 로직</span><span className="text-green-600">Phase 2에서 추가됨</span></div>
                        <div className="flex items-center justify-between p-2 bg-gray-100 rounded"><span>AI 개인화 추천 로직</span><span className="text-gray-500">Phase 3 개발 예정</span></div>
                      </div>
                    </div>
                  )}

                  {selectedLogic && (
                    <div className="mt-6 pt-6 border-t border-gray-200">
                      <div className="flex items-center justify-between mb-4">
                        <h4 className="text-lg font-bold">2단계: 적용 조건 설정 (고급 조건 빌더)</h4>
                        <button className="text-sm text-amber-600 hover:text-amber-800 font-medium">고급 조건 빌더 열기</button>
                      </div>

                      <div className="grid grid-cols-2 gap-4">
                        {conditionBlocks.map(condition => (
                          <label key={condition.id} className={"flex items-center p-3 border rounded-lg hover:bg-gray-50 " + (condition.phase > 2 ? "opacity-50 cursor-not-allowed" : "border-gray-200")}>
                            <input type="checkbox" className="mr-3"
                              onChange={e => {
                                if (e.target.checked) setSelectedConditions([...selectedConditions, condition]);
                                else setSelectedConditions(selectedConditions.filter(c => c.id !== condition.id));
                              }}/>
                            <div className="flex-1">
                              <span className="font-medium">{condition.name}</span>
                              <p className="text-sm text-gray-500">{condition.desc}</p>
                            </div>
                            <span className={"text-xs px-2 py-1 rounded-full " + (condition.phase === 1 ? "bg-blue-100 text-blue-700" : "bg-green-100 text-green-700")}>P{condition.phase}</span>
                          </label>
                        ))}
                      </div>

                      <div className="mt-4 p-3 bg-yellow-50 rounded-lg text-sm text-yellow-700">
                        "월 3회 이상 + 금요일 + VIP 고객 + 카테고리 제외" 같은 복잡한 조건도 AND/OR 로직으로 설정 가능
                      </div>
                    </div>
                  )}

                  {selectedLogic && (
                    <div className="mt-6 pt-6 border-t border-gray-200">
                      <h4 className="text-lg font-bold mb-4">3단계: API 호출 미리보기</h4>
                      <pre className="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm overflow-auto">{JSON.stringify({
                        type: selectedLogic.id,
                        name: selectedLogic.name,
                        phase: selectedLogic.phase,
                        conditions: selectedConditions.map(c => ({ id: c.id, phase: c.phase }))
                      }, null, 2)}</pre>
                    </div>
                  )}
                </div>

                <div className="space-y-4">
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h4 className="text-lg font-bold mb-4">혜택 미리보기</h4>
                    <div className="bg-gray-50 rounded-lg p-4 min-h-[100px] flex items-center justify-center mb-4 text-gray-400">
                      {selectedLogic ? "선택된 로직 조합을 기반으로 혜택이 생성됩니다" : "혜택 로직을 선택해주세요"}
                    </div>
                    <button disabled={!selectedLogic} className={"w-full py-3 px-4 rounded-lg font-semibold transition-all " + (selectedLogic ? "bg-amber-500 text-white hover:bg-amber-600" : "bg-gray-300 text-gray-500 cursor-not-allowed")}>
                      혜택 생성 (API 호출)
                    </button>
                  </div>
                </div>
              </div>
            </div>
          );
        }

        return (
          <div className="min-h-screen bg-gray-100">
            <header className="bg-white shadow-sm border-b">
              <div className="px-6 py-4 flex items-center justify-between">
                <div className="flex items-center space-x-4">
                  <h1 className="text-2xl font-bold text-gray-900">페이센터</h1>
                  <span className="text-sm text-gray-500">통합 혜택 관리 플랫폼</span>
                </div>
                <div className="flex items-center space-x-4">
                  <div className="relative">
                    <input type="text" placeholder="혜택 검색..." className="pl-3 pr-4 py-2 border border-gray-300 rounded-lg w-64" />
                  </div>
                  <IconBox />
                  <IconBox />
                </div>
              </div>

              <div className="px-6">
                <nav className="flex space-x-8">
                  {[
                    { id: "dashboard", name: "대시보드" },
                    { id: "benefits", name: "혜택 관리" },
                    { id: "create", name: "혜택 만들기" },
                    { id: "analytics", name: "분석" },
                    { id: "settlement", name: "정산" }
                  ].map(tab => (
                    <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={"py-3 px-1 border-b-2 font-medium text-sm " + (activeTab === tab.id ? "border-amber-500 text-amber-600" : "border-transparent text-gray-500 hover:text-gray-700")}>
                      {tab.name}
                    </button>
                  ))}
                </nav>
              </div>
            </header>

            <main className="px-6 py-6">
              {activeTab === "dashboard" && (
                <div className="space-y-6">
                  <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    {[
                      ["활성 혜택", "12"],
                      ["월 예산 소진율", "73%"],
                      ["평균 전환율", "9.2%"],
                      ["이번달 절약", "4.2억"]
                    ].map(([label, value], i) => (
                      <div key={i} className="bg-white rounded-lg shadow p-6">
                        <div className="flex items-center">
                          <div className="flex-1">
                            <p className="text-sm font-medium text-gray-600">{label}</p>
                            <p className="text-2xl font-bold text-gray-900">{value}</p>
                          </div>
                          <IconBox />
                        </div>
                      </div>
                    ))}
                  </div>

                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div className="bg-white rounded-lg shadow p-6">
                      <h3 className="text-lg font-semibold mb-4">월별 혜택 성과</h3>
                      <div style={{ width: "100%", height: 300 }}>
                        <ResponsiveContainer width="100%" height={300}>
                          <RLineChart data={performanceData}>
                            <CartesianGrid strokeDasharray="3 3" />
                            <XAxis dataKey="month" />
                            <YAxis />
                            <Tooltip />
                            <Line type="monotone" dataKey="발급" stroke="#4CAF50" strokeWidth={2} />
                            <Line type="monotone" dataKey="사용" stroke="#2196F3" strokeWidth={2} />
                          </RLineChart>
                        </ResponsiveContainer>
                      </div>
                    </div>

                    <div className="bg-white rounded-lg shadow p-6">
                      <h3 className="text-lg font-semibold mb-4">서비스별 혜택 사용 분포</h3>
                      <div style={{ width: "100%", height: 300 }}>
                        <ResponsiveContainer width="100%" height={300}>
                          <PieChart>
                            <Pie data={serviceDistribution} cx="50%" cy="50%" outerRadius={80} dataKey="value" label={({ name, value }) => name + " " + value + "%"}>
                              {serviceDistribution.map((entry, index) => <Cell key={index} fill={entry.color} />)}
                            </Pie>
                            <Tooltip />
                          </PieChart>
                        </ResponsiveContainer>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              {activeTab === "benefits" && (
                <div className="space-y-6">
                  <div className="bg-white rounded-lg shadow overflow-hidden">
                    <table className="min-w-full divide-y divide-gray-200">
                      <thead className="bg-gray-50">
                        <tr>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">혜택명</th>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">상태</th>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">예산 사용률</th>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">전환율</th>
                        </tr>
                      </thead>
                      <tbody className="bg-white divide-y divide-gray-200">
                        {benefitData.map((benefit, index) => (
                          <tr key={index} className="hover:bg-gray-50">
                            <td className="px-6 py-4 whitespace-nowrap">
                              <div>
                                <div className="text-sm font-medium text-gray-900">{benefit.name}</div>
                                <div className="text-sm text-gray-500">{benefit.type}</div>
                              </div>
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap">{getStatusBadge(benefit.status)}</td>
                            <td className="px-6 py-4 whitespace-nowrap">
                              <div className="flex items-center">
                                <div className="flex-1">
                                  <div className="w-full bg-gray-200 rounded-full h-2">
                                    <div className="bg-amber-600 h-2 rounded-full" style={{ width: ((benefit.used / benefit.budget) * 100) + "%" }}></div>
                                  </div>
                                </div>
                                <span className="ml-2 text-sm text-gray-500">{Math.round((benefit.used / benefit.budget) * 100)}%</span>
                              </div>
                            </td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{benefit.conversion}%</td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </div>
              )}

              {activeTab === "create" && <BenefitCreator />}

              {activeTab === "analytics" && (
                <div className="bg-white rounded-lg shadow p-6">
                  <h3 className="text-xl font-bold mb-6">심화 분석</h3>
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                      <h4 className="text-lg font-semibold mb-4">A/B 테스트 결과</h4>
                      <div className="border border-gray-200 rounded-lg p-4">
                        <div className="flex justify-between items-center mb-2">
                          <span className="font-medium">10% vs 15% 할인</span>
                          <span className="text-green-600 font-bold">15% 승리</span>
                        </div>
                        <div className="text-sm text-gray-600">전환율 차이: +2.3%p | 통계적 유의성: 95%</div>
                      </div>
                    </div>

                    <div>
                      <h4 className="text-lg font-semibold mb-4">ROI 분석</h4>
                      <div style={{ width: "100%", height: 200 }}>
                        <ResponsiveContainer width="100%" height={200}>
                          <RBarChart data={[
                            { service: "결제", roi: 320 },
                            { service: "카드", roi: 280 },
                            { service: "증권", roi: 450 },
                            { service: "멤버십", roi: 180 }
                          ]}>
                            <CartesianGrid strokeDasharray="3 3" />
                            <XAxis dataKey="service" />
                            <YAxis />
                            <Tooltip />
                            <Bar dataKey="roi" fill="#F59E0B" />
                          </RBarChart>
                        </ResponsiveContainer>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </main>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<PayCenterDashboard />);
    </script>
  </body>
</html>
